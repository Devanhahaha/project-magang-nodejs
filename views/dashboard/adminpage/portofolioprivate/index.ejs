<% var title="Portofolio Private" ; %>
<div class="container-xxl flex-grow-1 container-p-y">
  <div class="card shadow mb-4">
    <div class="card-header py-3 d-flex justify-content-between align-items-center">
      <h6 class="m-0 font-weight-bold text-primary">DataTables Portofolio Private</h6>
      <button class="btn btn-primary" onclick="clickPrint()"><i class="ti ti-plus"></i>Export</button>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-bordered" id="dataTable" width="100%">
          <thead>
            <tr class="text-nowrap">
              <th>No</th>
              <th>Nama Pekerjaan</th>
              <th>Bidang</th>
              <th>Lokasi</th>
              <th>Nama Pemberi Jasa</th>
              <th>Alamat Pemberi Jasa</th>
              <th>Nomor Kontrak</th>
              <th>Tanggal Kontrak</th>
              <th>Nilai (Rp)</th>
              <th>Tanggal Selesai Kontrak</th>
              <th>Tanggal Ba Serah Terima</th>
              <th>Tahun Anggaran</th>
            </tr>
          </thead>
          <tbody>
            <% portofolioprivates.forEach((item, index) => { %>
              <tr class="text-nowrap">
                <td><%= index + 1 %></td>
                <td><%= item.nama_pekerjaan %></td>
                <td><%= item.bidang %></td>
                <td><%= item.lokasi %></td>
                <td><%= item.pemberi_jasa_nama %></td>
                <td><%= item.pemberi_jasa_alamat %></td>
                <td><%= item.nomor_kontrak %></td>
                <td><%= item.tanggal_kontrak %></td>
                <td>Rp <%= item.nilai_kontrak ? Number(item.nilai_kontrak).toLocaleString('id-ID') : '0' %></td>
                <td><%= item.tanggal_selesai_kontrak %></td>
                <td><%= item.tanggal_ba_serah_terima %></td>
                <td><%= item.tahun_anggaran %></td>
              </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<% if (success && success.length> 0) { %>
<script>
  Swal.fire({
    icon: 'success',
    title: 'Berhasil!',
    text: '<%= success[0] %>', 
    showConfirmButton: false,
    timer: 15000
  });
</script>
<% } %>

<% if (error && error.length> 0) { %>
<script>
    Swal.fire({
    icon: 'error',
    title: 'Gagal!',
    text: '<%= error[0] %>', 
    showConfirmButton: false,
    timer: 15000
    });
</script>
<% } %>

<% if (errors && errors.length> 0 && old && old.id) { %>
<script>
  document.addEventListener("DOMContentLoaded", function () {
  const offcanvasEl = document.getElementById("editHome<%= old.id %>");
    if (offcanvasEl) {
    const offcanvas = new bootstrap.Offcanvas(offcanvasEl);
    offcanvas.show();
  }
  Swal.fire({
    icon: 'error',
    title: 'Validasi Gagal!',
    html: `<%= errors.join('<br>') %>`,
    confirmButtonText: 'OK'
  });
});
</script>
<% } %>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script>
  function clickPrint() {
    const element = document.querySelector('.table-responsive');
    const opt = {
      margin: 0.2,
      filename: 'Portofolio_Private.pdf',
      image: { type: 'jpeg', quality: 1 },
      html2canvas: { scale: 3, scrollX: 0, scrollY: 0, windowWidth: element.scrollWidth },
      jsPDF: { unit: 'pt', format: 'a4', orientation: 'landscape' }
    };
    html2pdf().set(opt).from(element).save();
  }
</script>